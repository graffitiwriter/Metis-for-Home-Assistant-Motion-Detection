# ==============================================================================
# SHELL COMMANDS FOR METIS HOME ASSISTANT INTEGRATION
# Add this section to your configuration.yaml
# After adding, go to Developer Tools > YAML > Restart > Shell Commands
# ==============================================================================

shell_command:
  # ------------------------------------------------------------------------------
  # HIGH-RES SNAPSHOT COMMANDS
  # Uses ffmpeg to grab frames directly from RTSP streams
  # ------------------------------------------------------------------------------
  
  # Front camera snapshot
  # REPLACE: Update RTSP URL with your camera's credentials and IP
  # -rtsp_transport tcp = use TCP (more reliable than UDP)
  # -i = input RTSP URL
  # -frames:v 1 = grab just 1 frame
  # -q:v 2 = high quality JPEG (1-31 scale, lower is better quality)
  # -y = overwrite output file if it exists
  # {{ filename }} = passed from automation as a variable
  snapshot_front: "ffmpeg -rtsp_transport tcp -i 'rtsp://admin:PASSWORD@192.168.1.10:554/cam/realmonitor?channel=1&subtype=0&unicast=true&proto=Onvif' -frames:v 1 -q:v 2 -y {{ filename }}"
  
  # Back camera snapshot
  # REPLACE: Update RTSP URL with your camera's credentials and IP
  snapshot_back: "ffmpeg -rtsp_transport tcp -i 'rtsp://admin:PASSWORD@192.168.1.11:554/cam/realmonitor?channel=1&subtype=0&unicast=true&proto=Onvif' -frames:v 1 -q:v 2 -y {{ filename }}"
  
  # ------------------------------------------------------------------------------
  # SNAPSHOT CLEANUP COMMAND
  # Automatically deletes old snapshots to save disk space
  # ------------------------------------------------------------------------------
  
  # Delete snapshot files older than 21 days
  # -name '*.jpg' = only .jpg files
  # -type f = only files (not directories)
  # -mtime +21 = modified more than 21 days ago
  # -delete = remove the files
  # ADJUST: Change +21 to a different number for different retention period
  cleanup_snapshots: "find /config/www/snapshots/ -name '*.jpg' -type f -mtime +21 -delete"
